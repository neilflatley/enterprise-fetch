<html>
  <head>
    <script type="module" src="tests/browser.js"></script>
    <script defer type="text/javascript">
      var appendLog = (message) => {
        var log = document.getElementById('log');
        var newmessage = document.createElement('div'); // Create a <li> node
        var text = document.createTextNode(message);
        newmessage.appendChild(text);
        log.appendChild(newmessage);
      };

      var addResponse = (response) => {
        var responseBlock = document.getElementById('response');
        var newmessage = document.createElement('div'); // Create a <li> node
        var text = document.createTextNode(JSON.stringify(response));
        newmessage.appendChild(text);
        responseBlock.appendChild(newmessage);
      };

      var goFetch = () => {
        var url = document.getElementById('url').value;
        var retries = document.getElementById('retries').value;
        fetch(url, {
          retry: {
            retries,
          },
        })
          .then((res) => {
            appendLog(res.status + ' ' + res.statusText);
            return res.json();
          })
          .then((json) => {
            addResponse(json);
          });
      };
    </script>
  </head>
  <body>
    <h1>Enterprise fetch test page</h1>
    <div id="log" class="log">
      <span>Empty</span>
    </div>
    <input type="text" id="url" value="https://httpbin.org/json" />
    <input type="text" id="retries" value="2" />
    <input type="button" id="goFetch" value="Fetch!" onclick="goFetch()" />
    <div id="response" class="response"></div>
  </body>
</html>
